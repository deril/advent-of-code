(in-package :aoc-2024-15)

(aoc:define-day 1430536 nil)


;;; Input

(defun separate-input (input)
  (let ((split (position "" input :test #'string=)))
    (values (subseq input 0 split)
            (subseq input (1+ split)))))

(defun parse-input (input)
  (multiple-value-bind (map movements) (separate-input input)
    (list (aoc:parse-grid-to-array map) (format nil "窿撖盹鲥礤铘螬┅ㄤ彐疳蜥礤翦轭瘐舄疳蝮瀛轭瘐ㄡ镢洪铕豸┅ㄤ彐疳蜥礤翦屮犴痨灞疳蝮瀛轭瘐Ж＃＃＃＃．袭袭＂＃喇袭＂．袭＂．．袭＂．袭＂．＂＃＃＃＃⒓揶揪决黾鼍决技┅ㄤ彐疳蜥礤翦屮犴痨宀疳蝮瀛轭瘐Ж＃＃＃＃＃．袭袭希．袭＂．舷袭希．侠袭＂Ｏ．袭＂Ｏ袭袭＂．舷袭舷＂．袭＂＃＃＃＃＃⒓鲻巨荐蘧鼍搛鲛鼍黾决搛荐嫁鲻技嫁炯季季决荐鲻季搛蘧藜技炯荐技荐搛鲛鼍蔻Ⅵ鲻技蘧搛揶炯季揪季藜季嫁鲻揶季鲻黾揪嫁搛巨决黾决技技黾搛巨嫁蘧揪藜黾觫⒕季鲻决搛藜揪季揪炯揶决鼍黾揶蘧决搛藜揶决揶决藜搛决季决搛藜鼍鲛藜揶鲻饥⒓荐嫁揪揶揶揪决藜决鲻蘧荐技季揶搛鲛荐鲻巨决嫁揶搛季蘧鲻鲻炯揪鲛技揶揶蔻⑥炯蘧季揪季揶技揶鼍揪嫁荐巨荐鼍决揪巨鼍季搛炯技荐揪黾黾鼍鲻鼍藜炯季蘧饥⑥揪季搛季嫁鲻黾揶季荐技技季嫁黾技炯技揶荐嫁揶炯蘧巨荐蘧技嫁揪搛荐搛荐蔻⒕蘧巨鼍鲻巨技搛季炯季技黾荐炯决嫁鲻技季揶鲛巨蘧揪技搛揪鲛鼍嫁蘧巨季鲻蔻⒓炯揶巨揶季荐鲻鲻搛荐技巨黾鼍黾嫁炯季技炯技揶技嫁技揪技炯揶蘧揶季蘧黾劲⑥蘧鲻嫁鲛黾鲻巨季荐嫁鼍揶蘧揪揶鲻鲛决鲻季揪藜蘧揪揪藜嫁鼍搛鲻季藜炯荐劲Ⅵ揶揪炯嫁藜揪搛藜鲛鲻季鲛技巨嫁鲛鼍嫁技季技藜鼍荐季鲻揪鼍荐藜鲻季鲛技蔻┅换嗅螋ㄤ彐躅轭轸獒飙痫箝糸镱磲皓ㄩ翦ㄦ矧骝镯忮祜ㄡ蝌狴溟礤铙轱磲癌ㄩ翦ㄦ矧骝镯忮祜ㄡ蝌狴溟礤铙轱磲暴麒孱ㄣ栳蚪ㄡ蝈磲戛＼扩箦翩ㄡ蝈磲戛＼蝈趱蝾骝镯轭轸獒飙痫箝糸镱ㄣ镯痨屮椹┅┅ㄤ彐躅轭篝蝓泗轱瞽麸溟蝈泗轱ㄩ铙趄蹉糸镱ㄣ狍轭篝蝓泗轱ǎ苻Ｃò暴ǎ荟Ｃò暴ǎ芫Ｃū癌ǎ芗Ｃō癌┅ㄤ彐躅骘祆秣轭篝蝓泗轱ㄩ铙趄蹉糸镱痫箝糸镱磲皓灬忮祗è铄舡骝邋痫箝糸镱痫溟颟戾è铄鳝痫ǐ痫溟颟┅ㄣ狍ㄡ镢恒蝈磲铄鳝痫螬ǎ墚铄鳝痫螬ǎ芟铄舡骝邋痫箝糸镱铄鳝痫溟颟雉桢蝼轶铋飑┅┅戾舄è溟ㄩ铙趄蹉糸镱麸溟蝈泗轱轭篝蝓泗轱瞟铄鳝痫箝糸镱ǐ痫箝糸镱溟颟┅ㄣ狍ㄡ镢恒蝈磲铄鳝痫箝糸镱ǎ埽痫箝糸镱ǎ墚铄鳝痫箝糸镱ǎ芟戾è铄舡骝邋箴雉铄舡骝邋痫箝糸镱痫箝糸镱溟颟┅ㄩ铛祆铄舡骝邋箴雉痫箝糸镱痱镧箦翩ㄡ镢恒蝈磲铄舡骝邋箴雉＼ㄡ镢恒蝈磲铄鳝痫箝糸镱＼铄鳝痫箝糸镱┅┅┅┅ㄤ彐躅骘祆秣轭篝蝓泗轱铙ㄩ铙趄蹉糸镱磲皓ㄩ翦ㄦ矧轭篝蝓泗轱轭篝蜷铉轭篝蝓泗轱铙ㄦ矧痫轭轸獒祆ㄩ铋糸犰痫箝糸镱磲皓翳孱ㄦ镬祜鳝轭篝蝓泗轱轭篝蝓泗轱痫磲皓┅ㄤ彐躅汜煦怙弩琊磲皓ㄩ翦秕翦ㄦ矧骝镯忮祜ㄡ蝌狴溟礤铙轱磲癌ㄩ翦ㄦ矧骝镯忮祜ㄡ蝌狴溟礤铙轱磲暴麒孱ㄣ栳蚪ㄡ蝈磲戛＼烯ㄩ秕翦篚眄轭ǐí卑椹戛┅┅┅ㄤ彐躅珏舡犷篦弪é镳糸镱犰ㄩ铕豸轭瘐舄┅ㄤ弩趄蹉趱蜷铉忾钿磲轭篝蝓泗轱铙轭瘐戾è磲ㄡ戾犷潋獒恒镳狎蜥磲皓┅ㄦ镬祜鳝轭篝蝓泗轱铙轭篝蝓泗轱铙磲皓ㄣ犰悱怙弩琊磲皓┅ㄡ镢虹轹孱舶哺ㄧ弭犷篦弪屮犴痨灞┅卑肮ㄧ弭犷篦弪屮犴痨宀┅